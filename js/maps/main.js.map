{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","db","firebase","initializeApp","database","app","m_ocean","m_Constants","CameraYOffset","OceanYOffset","OceanPadding","ShipYOffset","SinkDistance","BulletArc","WaitTimePerTileMoved","WaitTimeBetweenAction","m_input","m_ships","m_chain","m_entity","init","ships","input","turns","ocean","map","preprocess","doc","document","getElementById","track","createElement","setAttribute","appendChild","render","setTimeout","simulate","data","translate","d","res","hasOwnProperty","atX","atY","x","z","y","actions","index","Math","floor","width","depth","density","console","log","forEach","entry","push","chain","id","type","shipData","camera","atan","String","ship","dataset","name","owner","health","hull","firepower","speed","range","heart","parseInt","color","shipInstance","sinkShip","Promise","resolve","reject","shipDom","debug","point1","point2","addEventListener","event","removeAttribute","parentNode","removeChild","hasChildNodes","childNodes","fireShip","bullet","source","arc","target","atZ","tmp","aimShip","action","className","getAttribute","PI","hitShip","moveShip","point","previous","xDistance","zDistance","abs","direction","dur","notStop","current","shift","then","done","catch","err","error","warn","vex","dialog","alert","rotateVector","vec3","deg","cos","getStrCoord","coord","offsetY","getShips","getOcean","battleship","params","qs","split","join","tokens","re","exec","decodeURIComponent","getQueryParams","location","search","getDataFromCode","ref","once","snapshot","gameData","val","getCode","message","prompt","callback","value"],"mappings":"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","file":"../main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\n// Initialize Firebase\nvar config = {\n\tapiKey: \"AIzaSyA9EYUXVL5WAh6Aam1qXlWyvi3b7HLcZ1U\",\n\tauthDomain: \"esigamma.firebaseapp.com\",\n\tdatabaseURL: \"https://esigamma.firebaseio.com\",\n\tprojectId: \"esigamma\",\n\tstorageBucket: \"esigamma.appspot.com\",\n\tmessagingSenderId: \"734163636039\"\n};\nvar FirebaseInstance = firebase.initializeApp(config, \"Davy Jones' Locker\");\n\nvar db = FirebaseInstance.database();\n\nfunction getQueryParams(qs) {\n\tqs = qs.split('+').join(' ');\n\tvar params = {},\n\t    tokens,\n\t    re = /[?&]?([^=]+)=([^&]*)/g;\n\twhile (tokens = re.exec(qs)) {\n\t\tparams[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\treturn params;\n}\n\nfunction battleship() {\n\n\t// private\n\tvar m_Constants = {\n\t\tCameraYOffset: 10,\n\t\tOceanYOffset: 0,\n\t\tOceanPadding: 10,\n\t\tShipYOffset: 0,\n\t\tSinkDistance: 5,\n\t\tBulletArc: 2,\n\t\tWaitTimePerTileMoved: 300,\n\t\tWaitTimeBetweenAction: 100 // in miliseconds\n\t};\n\n\tvar m_input = {};\n\n\tvar m_ships = []; // stores formatted json of ship initialization\n\tvar m_chain = []; // stores chainable actions in a turn\n\tvar m_entity = {}; // object with id to html dom element of ships\n\n\tvar m_test = 0;\n\n\tvar m_ocean;\n\n\t// public\n\tvar app = {\n\n\t\tinit: function init() {\n\t\t\t// default access of data when there are no connectivity\n\t\t\tm_input = { \"ships\": input.init.ships, \"turns\": input.turns, \"ocean\": input.init.map };\n\t\t\tapp.preprocess(m_input);\n\n\t\t\tvar doc = document.getElementById('scene');\n\t\t\tvar track = document.createElement('a-curve');\n\t\t\ttrack.setAttribute('id', 'track');\n\t\t\ttrack.setAttribute('type', 'Line');\n\t\t\tdoc.appendChild(track);\n\n\t\t\tapp.render(m_ships);\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tapp.simulate();\n\t\t\t}, 10000);\n\t\t\t// call function to wait a bit before starting simulation\n\t\t\t//app.simulate();\n\t\t},\n\n\t\tpreprocess: function preprocess(data) {\n\t\t\tvar translate = function translate(d) {\n\t\t\t\tvar res = d;\n\t\t\t\tif (res.hasOwnProperty(\"atX\") && res.hasOwnProperty(\"atY\")) {\n\t\t\t\t\tres['atX'] = 4 * d.atX;\n\t\t\t\t\tres['atZ'] = 4 * d.atY; // make sure to move the y property before overriding it\n\t\t\t\t\tres['atY'] = m_Constants.ShipYOffset;\n\t\t\t\t}\n\t\t\t\tres.x = 4 * d.x;\n\t\t\t\tres.z = 4 * d.y; // make sure to move the y property before overriding it\n\t\t\t\tres.y = m_Constants.ShipYOffset;\n\t\t\t\treturn res;\n\t\t\t};\n\t\t\tvar actions = [];\n\t\t\tvar index = 0;\n\n\t\t\t// preprocess initial map information\n\t\t\t// m_ocean = { \"x\": ((4*Math.floor(data.ocean.x/2))-2) + (m_Constants.OceanPadding/2),\n\t\t\t//             \"y\": m_Constants.OceanYOffset, \n\t\t\t//             \"z\": ((4*Math.floor(data.ocean.y/2))) + (m_Constants.OceanPadding/2), \n\t\t\t//             \"width\": (4*data.ocean.x)+m_Constants.OceanPadding, \n\t\t\t//             \"depth\": (4*data.ocean.y)+m_Constants.OceanPadding, \n\t\t\t//             \"density\": Math.min(3*data.ocean.x, 3*data.ocean.y)+m_Constants.OceanPadding\n\t\t\t//         };\n\t\t\tm_ocean = { \"x\": 4 * Math.floor(data.ocean.x / 2) - 2,\n\t\t\t\t\"y\": m_Constants.OceanYOffset,\n\t\t\t\t\"z\": 4 * Math.floor(data.ocean.y / 2),\n\t\t\t\t\"width\": 200,\n\t\t\t\t\"depth\": 200,\n\t\t\t\t\"density\": 120\n\t\t\t};\n\n\t\t\tconsole.log(data);\n\t\t\t// preprocess initial ship information\n\t\t\tdata.ships.forEach(function (entry) {\n\t\t\t\tm_ships.push(translate(entry));\n\t\t\t});\n\n\t\t\t// preprocess actions and turns information\n\t\t\twhile (index < data.turns.length) {\n\t\t\t\tvar chain = true;\n\t\t\t\twhile (chain) {\n\t\t\t\t\tif (index === data.turns.length) break;\n\n\t\t\t\t\tif (actions.length === 0) {\n\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t\t// Ship id and action type has to be the same to be considered a chain-able action\n\t\t\t\t\telse if (actions[0].id === data.turns[index].id && actions[0].type === data.turns[index].type) {\n\t\t\t\t\t\t\tif (actions[0].type === \"MOVE\") {\n\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Firing must be at the same coordinates to be considered a chain-able action\n\t\t\t\t\t\t\telse if (actions[0].type === \"FIRE\" && actions[0].atX === 4 * data.turns[index].atX && actions[0].atY === 4 * data.turns[index].atY) {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else if (actions[0].type === \"SINK\") {\n\t\t\t\t\t\t\t\t\tactions.push(translate(data.turns[index]));\n\t\t\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchain = false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// add action chain to variable\n\t\t\t\tm_chain.push({ \"type\": actions[0].type, \"actions\": actions });\n\t\t\t\t// reset chain actions\n\t\t\t\tactions = [];\n\t\t\t}\n\t\t\tconsole.log(m_chain);\n\t\t},\n\n\t\t// Displays the ocean, and ships\n\t\t// TODO: check the edge cases with the map edges/sizes\n\t\trender: function render(shipData) {\n\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\n\t\t\t// re-position camera: camera must be already present when html loads\n\t\t\tvar camera = document.getElementById('camera');\n\t\t\t//camera.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tcamera.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + (m_ocean.z + 1.5 * m_ocean.x));\n\t\t\tcamera.setAttribute('camera', 'userHeight: ' + m_Constants.CameraYOffset);\n\t\t\tcamera.setAttribute('rotation', -Math.atan(m_Constants.CameraYOffset / (m_ocean.z + m_ocean.x)));\n\n\t\t\t// Generate Map\n\t\t\t// TODO: Possible edge cases with the map edge not being big enough\n\t\t\tvar map = document.createElement('a-ocean');\n\n\t\t\tmap.setAttribute('position', m_ocean.x + \" \" + m_ocean.y + \" \" + m_ocean.z);\n\t\t\tmap.setAttribute('width', String(m_ocean.width));\n\t\t\tmap.setAttribute('depth', String(m_ocean.depth));\n\t\t\tmap.setAttribute('density', String(m_ocean.density));\n\t\t\tdoc.appendChild(map);\n\n\t\t\t// Spawn Ships\n\t\t\tshipData.forEach(function (entry) {\n\t\t\t\tvar ship = document.createElement('a-entity');\n\n\t\t\t\tship.dataset.id = entry.id;\n\t\t\t\tship.dataset.name = entry.name;\n\t\t\t\tship.dataset.owner = entry.owner;\n\t\t\t\tship.dataset.x = entry.x;\n\t\t\t\tship.dataset.y = entry.y;\n\t\t\t\tship.dataset.z = entry.z;\n\t\t\t\tship.dataset.health = entry.hull;\n\t\t\t\tship.dataset.hull = entry.hull;\n\t\t\t\tship.dataset.firepower = entry.firepower;\n\t\t\t\tship.dataset.speed = entry.speed;\n\t\t\t\tship.dataset.range = entry.range;\n\n\t\t\t\tvar heart = \"\";\n\t\t\t\tfor (var i = 0; i < parseInt(entry.hull); i++) {\n\t\t\t\t\theart += \" •\";\n\t\t\t\t}\n\n\t\t\t\tship.setAttribute('position', entry.x + \" \" + entry.y + \" \" + entry.z);\n\t\t\t\tship.setAttribute('template', 'src: #boat-template');\n\t\t\t\tship.setAttribute('class', 'boat');\n\t\t\t\t// ${variable} <- variable name be lower case\n\t\t\t\tship.setAttribute('data-ship_color', 'color: ' + entry.color + '; metalness: 0.4;');\n\t\t\t\tship.setAttribute('data-ship_name', 'value: ' + entry.name + '; font: #play;');\n\t\t\t\tship.setAttribute('data-ship_health', 'value: ' + heart + ';');\n\n\t\t\t\tvar shipInstance = doc.appendChild(ship);\n\t\t\t\tm_entity[entry.id] = shipInstance;\n\t\t\t});\n\t\t},\n\n\t\tsinkShip: function sinkShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar shipDom = m_entity[data[0].id];\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: black;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar point1 = document.createElement('a-curve-point');\n\t\t\t\tvar point2 = document.createElement('a-curve-point');\n\t\t\t\tpoint1.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tpoint2.setAttribute('position', data[0].x + \" \" + (data[0].y - m_Constants.SinkDistance) + \" \" + data[0].z);\n\t\t\t\ttrack.appendChild(point1);\n\t\t\t\ttrack.appendChild(point2);\n\n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 1 0; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: 3000;');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\n\t\t\t\t\tif (shipDom.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(shipDom);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t\t// resolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in are one ships action of firing at one and only one coordinate\n\t\tfireShip: function fireShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar ship = m_entity[data[0].id];\n\n\t\t\t\t// var bullet = []; // list implementation allows addition of features in the future\n\t\t\t\t// if (ship.className === \"boat\") {\n\t\t\t\t// \tfor (var i = 0; i < ship.childNodes.length; i++) {\n\n\t\t\t\t// \t}\n\t\t\t\t// }\n\n\t\t\t\tvar bullet = document.createElement('a-sphere');\n\t\t\t\tvar source = document.createElement('a-curve-point');\n\t\t\t\tvar arc = document.createElement('a-curve-point');\n\t\t\t\tvar target = document.createElement('a-curve-point');\n\t\t\t\tbullet.setAttribute('color', 'gray');\n\t\t\t\tbullet.setAttribute('radius', '0.1');\n\t\t\t\tbullet.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\tsource.setAttribute('position', data[0].x + \" \" + data[0].y + \" \" + data[0].z);\n\t\t\t\ttarget.setAttribute('position', data[0].atX + \" \" + data[0].atY + \" \" + data[0].atZ);\n\t\t\t\tarc.setAttribute('position', (data[0].atX + data[0].x) / 2 + \" \" + ((data[0].atY + data[0].y) / 2 + m_Constants.BulletArc) + \" \" + (data[0].atZ + data[0].z) / 2);\n\t\t\t\ttrack.appendChild(source);\n\t\t\t\ttrack.appendChild(arc);\n\t\t\t\ttrack.appendChild(target);\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: red;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\tvar tmp = doc.appendChild(bullet);\n\t\t\t\ttmp.setAttribute('alongpath', 'curve: #track; rotate: true; constant: 0 0 1; delay: 200; dur: 500');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\ttmp.removeAttribute('alongpath');\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\t// var action = null;\n\t\t\t\t\t// if (ship.className == \"boat\") {\n\t\t\t\t\t// \tfor(var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t\t// \t\tif (ship.childNodes[i].className === \"aimShip\") {\n\t\t\t\t\t// \t\t\taction = ship.childNodes[i];\n\t\t\t\t\t// \t\t\tbreak;\n\t\t\t\t\t// \t\t}\n\t\t\t\t\t// \t}\n\t\t\t\t\t// \tif (action) {\n\t\t\t\t\t// \t\t//action.removeAttribute('look-at');\n\t\t\t\t\t// \t}\n\t\t\t\t\t// }\n\n\t\t\t\t\t//tmp.removeEventListener('movingended', done);\n\t\t\t\t\tif (tmp.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(tmp);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\ttmp.addEventListener('movingended', done);\n\t\t\t\t//resolve();\n\t\t\t});\n\t\t},\n\n\t\taimShip: function aimShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tconsole.log('aim info: ', data);\n\t\t\t\tvar doc = document.getElementById('scene');\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\tvar ship = m_entity[data[0].id];\n\n\t\t\t\tvar action = null;\n\t\t\t\tconsole.log(\"className\", ship.className);\n\t\t\t\tconsole.log(ship);\n\t\t\t\tif (ship.className == \"boat\") {\n\t\t\t\t\tfor (var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t\t\tif (ship.childNodes[i].className === \"aimShip\") {\n\t\t\t\t\t\t\taction = ship.childNodes[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (action) {\n\t\t\t\t\t\tvar current = action.getAttribute(\"rotation\").y;\n\t\t\t\t\t\tvar radian = Math.atan((data[0].atZ - data[0].z) / (data[0].atX - data[0].x));\n\t\t\t\t\t\tvar degree = radian * 180 / Math.PI;\n\n\t\t\t\t\t\taction.setAttribute('look-at', data[0].atX + ' ' + data[0].atY + ' ' + data[0].z);\n\n\t\t\t\t\t\t//console.log('current-rotation: ', current);\n\n\t\t\t\t\t\t//console.log('delta-rotation: ', radian, degree);\n\t\t\t\t\t\t//action.setAttribute()\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (action) {\n\t\t\t\t\taction.removeAttribute('look-at');\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t});\n\t\t},\n\n\t\thitShip: function hitShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar ship = m_entity[data[0].id];\n\t\t\t\tvar heart = \"\";\n\n\t\t\t\tfor (var i = 0; i < data[0].health; i++) {\n\t\t\t\t\theart += \" •\";\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0; i < ship.childNodes.length; i++) {\n\t\t\t\t\tif (ship.childNodes[i].className == \"ship-health\") {\n\t\t\t\t\t\tship.childNodes[i].setAttribute('text-geometry', 'value: ' + heart + ';');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t},\n\n\t\t// Data passed in must be for movement of one ship\n\t\tmoveShip: function moveShip(data) {\n\t\t\treturn new Promise(function (resolve, reject) {\n\t\t\t\tvar shipDom = m_entity[data[0].id]; // html element\n\t\t\t\t// if statement is not working\n\t\t\t\t// if (data.length === 1 && data[0].x === shipDom.dataset.x && data[0].z === shipDom.dataset.z) {\n\t\t\t\t//     // if shipDom tries to move against edge or occupied place\n\t\t\t\t//     alert(\"Skipped\");\n\t\t\t\t//     resolve(\"Skipped\");\n\t\t\t\t// }\n\n\t\t\t\tvar doc = document.getElementById('scene'); // <a-scene> reference\n\t\t\t\tvar track = document.getElementById('track');\n\t\t\t\t//var startCoord = {\"x\": data[0].x};\n\n\t\t\t\tvar debug = document.createElement('a-draw-curve');\n\t\t\t\tdebug.setAttribute('curveref', '#track');\n\t\t\t\tdebug.setAttribute('material', 'shader: line; color: blue;');\n\t\t\t\tdoc.appendChild(debug);\n\n\t\t\t\t// add current location as a starting point of the curve\n\t\t\t\tvar point = document.createElement('a-curve-point');\n\t\t\t\tpoint.setAttribute('position', String(shipDom.dataset.x + \" \" + shipDom.dataset.y + \" \" + shipDom.dataset.z));\n\t\t\t\ttrack.appendChild(point);\n\t\t\t\t// add chain-able goal locations to the curve\n\n\t\t\t\t//previous is used to check for movement against walls, e.g. previous location same as current and next\n\t\t\t\t//previous can also be used to get the last action which determines the final rotation where the ship should point\n\t\t\t\tvar previous = { 'x': shipDom.dataset.x, 'z': shipDom.dataset.z };\n\t\t\t\tvar xDistance = 0;\n\t\t\t\tvar zDistance = 0;\n\t\t\t\tconsole.log(\"Moving: \", data);\n\t\t\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\t\t\tpoint = document.createElement('a-curve-point');\n\t\t\t\t\tpoint.setAttribute('position', data[i].x + \" \" + data[i].y + \" \" + data[i].z);\n\t\t\t\t\txDistance += Math.abs(data[i].x - previous.x);\n\t\t\t\t\tzDistance += Math.abs(data[i].z - previous.z);\n\t\t\t\t\tif (i + 1 < data.length && data[i].x === data[i + 1].x && data[i].z === data[i + 1].z) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\ttrack.appendChild(point);\n\t\t\t\t\tprevious = { 'x': data[i].x, 'z': data[i].z, 'direction': data[i].direction };\n\t\t\t\t}\n\t\t\t\t// console.log(\"everything\", data);\n\t\t\t\t// var rotationY = 45;\n\t\t\t\t// console.log('end direction', previous.direction);\n\t\t\t\t// if (previous.direction == 'North') \n\t\t\t\t// \trotationY = 0;\n\t\t\t\t// else if (previous.direction == 'West')\n\t\t\t\t// \trotationY = 90;\n\t\t\t\t// else if (previous.direction == 'South')\n\t\t\t\t// \trotationY = 180;\n\t\t\t\t// else if (previous.direction == 'East')\n\t\t\t\t// \trotationY = 270;\n\t\t\t\t// else \n\t\t\t\t// \trotationY = 295;\n\n\n\t\t\t\tvar dur = (xDistance + zDistance) * m_Constants.WaitTimePerTileMoved; // determines the length in time of the movement \n\t\t\t\tshipDom.setAttribute('alongpath', 'curve: #track; rotate: true; constraint: 0 0 1; delay: ' + m_Constants.WaitTimeBetweenAction + '; dur: ' + dur + ';');\n\n\t\t\t\tvar done = function done(event) {\n\t\t\t\t\t// var list = document.getElementByTagName('a-draw-curve');\n\t\t\t\t\t// for (var i = 0; i < list.length; i++) {\n\t\t\t\t\t//     list[0].parentNode.removeChild(list[0]);\n\t\t\t\t\t// }\n\t\t\t\t\tif (debug.parentNode) {\n\t\t\t\t\t\tdoc.removeChild(debug);\n\t\t\t\t\t}\n\n\t\t\t\t\twhile (track.hasChildNodes()) {\n\t\t\t\t\t\ttrack.removeChild(track.childNodes[0]);\n\t\t\t\t\t}\n\n\t\t\t\t\tshipDom.removeAttribute('alongpath');\n\t\t\t\t\tshipDom.dataset.x = data[data.length - 1].x;\n\t\t\t\t\tshipDom.dataset.z = data[data.length - 1].z;\n\t\t\t\t\tshipDom.dataset.y = data[data.length - 1].y;\n\n\t\t\t\t\t//console.log('end path', rotationY);\n\t\t\t\t\t//shipDom.setAttribute('rotation', '0 ' + rotationY + ' 0');\n\n\t\t\t\t\t//shipDom.removeEventListener('movingended', done);\n\t\t\t\t\tresolve(event);\n\t\t\t\t};\n\n\t\t\t\tshipDom.addEventListener('movingended', done);\n\t\t\t});\n\t\t},\n\n\t\tsimulate: function simulate() {\n\t\t\tconsole.log(\"chain: \", m_chain);\n\t\t\tvar notStop = true;\n\t\t\tif (m_chain.length == 0) {\n\t\t\t\tnotStop = false;\n\t\t\t}\n\t\t\tvar current = m_chain.shift(); // don't shift when length is zero\n\t\t\tif (current && notStop) {\n\t\t\t\tconsole.log(\"current: \", current);\n\t\t\t\tswitch (current.type) {\n\t\t\t\t\tcase \"MOVE\":\n\t\t\t\t\t\tapp.moveShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Moved \" + m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"FIRE\":\n\t\t\t\t\t\tapp.aimShip(current.actions).then(function (done) {\n\n\t\t\t\t\t\t\tapp.fireShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\t\tconsole.error(\"error: \", err);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(\"error: \", err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"HIT\":\n\t\t\t\t\t\tapp.hitShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"SINK\":\n\t\t\t\t\t\tapp.sinkShip(current.actions).then(function (done) {\n\t\t\t\t\t\t\t//alert(\"Sunk \"+ m_chain.length + \" actions left\");\n\t\t\t\t\t\t\tapp.simulate();\n\t\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown Action Type \" + current.type + \" in simulate function, skipping.\");\n\t\t\t\t\t\tapp.simulate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t//alert(\"Simulation Done\");\n\t\t\t\t\tvex.dialog.alert(\"Simulation Completed.\");\n\t\t\t\t}, 10000);\n\t\t\t}\n\t\t},\n\n\t\trotateVector: function rotateVector(vec3, deg) {\n\n\t\t\treturn {\n\t\t\t\t\"x\": vec3.x * cos()\n\t\t\t};\n\t\t},\n\n\t\t/** translates the coordinate in the java game to this scene's coordinate\n  \tJava Game: Each ship spans one (x, y) unit\n  \tJava Game: Coordinate system has (0, 0) at top left corner (without negatives)\n  \tAFrame Scene: Each ship model is a 4x4 box\n  \tAFrame Scene: Coordinate system is (0, 0) at the center (with negatives)\n  */\n\t\tgetStrCoord: function getStrCoord(coord, offsetY) {\n\t\t\treturn (m_ocean.x - coord.x) * 4 + \" \" + offsetY + \" \" + (m_ocean.y - coord.y) * 4;\n\t\t},\n\n\t\tgetShips: function getShips() {\n\t\t\treturn m_ships;\n\t\t},\n\n\t\tgetOcean: function getOcean() {\n\t\t\treturn m_ocean;\n\t\t}\n\n\t};\n\n\treturn app;\n}\n\nvar app = battleship();\nvar params = getQueryParams(document.location.search);\n\nvar getDataFromCode = function getDataFromCode(code) {\n\tdb.ref('davy-jones-locker/' + code).once('value', function (snapshot) {\n\t\tvar gameData = snapshot.val();\n\t\tif (gameData) {\n\t\t\tinput = gameData;\n\t\t\tapp.init();\n\t\t} else {\n\t\t\tgetCode(\"No data for code \" + code + \". Enter another code:\");\n\t\t\t//app.init();\n\t\t}\n\t}).catch(function (err) {\n\t\tgetCode(\"There was an error. Enter another code:\");\n\t\t//app.init();\n\t});\n};\n\nvar getCode = function getCode(message) {\n\tvex.dialog.prompt({\n\t\tmessage: message,\n\t\tcallback: function callback(value) {\n\t\t\tif (value) {\n\t\t\t\tvar code = value;\n\t\t\t\tgetDataFromCode(code);\n\t\t\t} else {\n\t\t\t\tgetCode(\"No code entered. Enter your code:\");\n\t\t\t}\n\t\t}\n\t});\n};\n\nif (params.code) {\n\tgetDataFromCode(params.code);\n} else {\n\tgetCode(\"Enter Your Code\");\n}\n\n// var BATTLE_SERVER_URL = 'https://battleship-vingkan.c9users.io/1v1?p1=esi17.cs.DestroyerShip&p2=esi17.hli109.Floater';// + Math.ceil(Math.random() * 100);\n\n// $.get(BATTLE_SERVER_URL).then(data => {\n// \tinput = data;\n// \tapp.init();\n// }).done(() => {\n// \tconsole.log(\"Data successfully retrieved from server\");\n// }).fail(() => {\n// \tconsole.log(\"Unable to retrieve data, starting with local data\");\n// \tapp.init();\n// });\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7QUFDQSxJQUFJLFNBQVM7QUFDWixTQUFRLHlDQURJO0FBRVosYUFBWSwwQkFGQTtBQUdaLGNBQWEsaUNBSEQ7QUFJWixZQUFXLFVBSkM7QUFLWixnQkFBZSxzQkFMSDtBQU1aLG9CQUFtQjtBQU5QLENBQWI7QUFRQSxJQUFJLG1CQUFtQixTQUFTLGFBQVQsQ0FBdUIsTUFBdkIsRUFBK0Isb0JBQS9CLENBQXZCOztBQUVBLElBQUksS0FBSyxpQkFBaUIsUUFBakIsRUFBVDs7QUFFQSxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDM0IsTUFBSyxHQUFHLEtBQUgsQ0FBUyxHQUFULEVBQWMsSUFBZCxDQUFtQixHQUFuQixDQUFMO0FBQ0EsS0FBSSxTQUFTLEVBQWI7QUFBQSxLQUNDLE1BREQ7QUFBQSxLQUVDLEtBQUssdUJBRk47QUFHQSxRQUFPLFNBQVMsR0FBRyxJQUFILENBQVEsRUFBUixDQUFoQixFQUE2QjtBQUM1QixTQUFPLG1CQUFtQixPQUFPLENBQVAsQ0FBbkIsQ0FBUCxJQUF3QyxtQkFBbUIsT0FBTyxDQUFQLENBQW5CLENBQXhDO0FBQ0E7QUFDRCxRQUFPLE1BQVA7QUFDQTs7QUFFRCxTQUFTLFVBQVQsR0FBc0I7O0FBRXJCO0FBQ0EsS0FBSSxjQUFjO0FBQ2pCLGlCQUFlLEVBREU7QUFFakIsZ0JBQWMsQ0FGRztBQUdqQixnQkFBYyxFQUhHO0FBSWpCLGVBQWEsQ0FKSTtBQUtqQixnQkFBYyxDQUxHO0FBTWpCLGFBQVcsQ0FOTTtBQU9qQix3QkFBc0IsR0FQTDtBQVFqQix5QkFBdUIsR0FSTixDQVFVO0FBUlYsRUFBbEI7O0FBV0EsS0FBSSxVQUFVLEVBQWQ7O0FBRUEsS0FBSSxVQUFVLEVBQWQsQ0FoQnFCLENBZ0JIO0FBQ2xCLEtBQUksVUFBVSxFQUFkLENBakJxQixDQWlC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VUFBVSxTQUFWLE9BQVUsQ0FBQyxPQUFELEVBQWE7QUFDMUIsS0FBSSxNQUFKLENBQVcsTUFBWCxDQUFrQjtBQUNqQixXQUFTLE9BRFE7QUFFakIsWUFBVSxrQkFBQyxLQUFELEVBQVc7QUFDcEIsT0FBSSxLQUFKLEVBQVc7QUFDVixRQUFJLE9BQU8sS0FBWDtBQUNBLG9CQUFnQixJQUFoQjtBQUNBLElBSEQsTUFHTztBQUNOLFlBQVEsbUNBQVI7QUFDQTtBQUNEO0FBVGdCLEVBQWxCO0FBV0EsQ0FaRDs7QUFjQSxJQUFJLE9BQU8sSUFBWCxFQUFpQjtBQUNoQixpQkFBZ0IsT0FBTyxJQUF2QjtBQUNBLENBRkQsTUFFTztBQUNOLFNBQVEsaUJBQVI7QUFDQTs7QUFHRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZVxudmFyIGNvbmZpZyA9IHtcblx0YXBpS2V5OiBcIkFJemFTeUE5RVlVWFZMNVdBaDZBYW0xcVhsV3l2aTNiN0hMY1oxVVwiLFxuXHRhdXRoRG9tYWluOiBcImVzaWdhbW1hLmZpcmViYXNlYXBwLmNvbVwiLFxuXHRkYXRhYmFzZVVSTDogXCJodHRwczovL2VzaWdhbW1hLmZpcmViYXNlaW8uY29tXCIsXG5cdHByb2plY3RJZDogXCJlc2lnYW1tYVwiLFxuXHRzdG9yYWdlQnVja2V0OiBcImVzaWdhbW1hLmFwcHNwb3QuY29tXCIsXG5cdG1lc3NhZ2luZ1NlbmRlcklkOiBcIjczNDE2MzYzNjAzOVwiXG59O1xudmFyIEZpcmViYXNlSW5zdGFuY2UgPSBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZywgXCJEYXZ5IEpvbmVzJyBMb2NrZXJcIik7XG5cbnZhciBkYiA9IEZpcmViYXNlSW5zdGFuY2UuZGF0YWJhc2UoKTtcblxuZnVuY3Rpb24gZ2V0UXVlcnlQYXJhbXMocXMpIHtcblx0cXMgPSBxcy5zcGxpdCgnKycpLmpvaW4oJyAnKTtcblx0dmFyIHBhcmFtcyA9IHt9LFxuXHRcdHRva2Vucyxcblx0XHRyZSA9IC9bPyZdPyhbXj1dKyk9KFteJl0qKS9nO1xuXHR3aGlsZSAodG9rZW5zID0gcmUuZXhlYyhxcykpIHtcblx0XHRwYXJhbXNbZGVjb2RlVVJJQ29tcG9uZW50KHRva2Vuc1sxXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHRva2Vuc1syXSk7XG5cdH1cblx0cmV0dXJuIHBhcmFtcztcbn1cblxuZnVuY3Rpb24gYmF0dGxlc2hpcCgpIHtcblx0XG5cdC8vIHByaXZhdGVcblx0dmFyIG1fQ29uc3RhbnRzID0ge1xuXHRcdENhbWVyYVlPZmZzZXQ6IDEwLFxuXHRcdE9jZWFuWU9mZnNldDogMCxcblx0XHRPY2VhblBhZGRpbmc6IDEwLFxuXHRcdFNoaXBZT2Zmc2V0OiAwLFxuXHRcdFNpbmtEaXN0YW5jZTogNSxcblx0XHRCdWxsZXRBcmM6IDIsXG5cdFx0V2FpdFRpbWVQZXJUaWxlTW92ZWQ6IDMwMCxcblx0XHRXYWl0VGltZUJldHdlZW5BY3Rpb246IDEwMCAvLyBpbiBtaWxpc2Vjb25kc1xuXHR9O1xuXG5cdHZhciBtX2lucHV0ID0ge307XG5cdFxuXHR2YXIgbV9zaGlwcyA9IFtdOyAvLyBzdG9yZXMgZm9ybWF0dGVkIGpzb24gb2Ygc2hpcCBpbml0aWFsaXphdGlvblxuXHR2YXIgbV9jaGFpbiA9IFtdOyAvLyBzdG9yZXMgY2hhaW5hYmxlIGFjdGlvbnMgaW4gYSB0dXJuXG5cdHZhciBtX2VudGl0eSA9IHt9OyAvLyBvYmplY3Qgd2l0aCBpZCB0byBodG1sIGRvbSBlbGVtZW50IG9mIHNoaXBzXG5cblx0dmFyIG1fdGVzdCA9IDA7XG5cblx0dmFyIG1fb2NlYW47IFxuXG5cdC8vIHB1YmxpY1xuXHR2YXIgYXBwID0ge1xuXG5cdFx0aW5pdDogKCkgPT4ge1xuXHRcdFx0Ly8gZGVmYXVsdCBhY2Nlc3Mgb2YgZGF0YSB3aGVuIHRoZXJlIGFyZSBubyBjb25uZWN0aXZpdHlcblx0XHRcdG1faW5wdXQgPSB7XCJzaGlwc1wiOiBpbnB1dC5pbml0LnNoaXBzLCBcInR1cm5zXCI6IGlucHV0LnR1cm5zLCBcIm9jZWFuXCI6IGlucHV0LmluaXQubWFwfTtcblx0XHRcdGFwcC5wcmVwcm9jZXNzKG1faW5wdXQpO1xuXG5cdFx0XHR2YXIgZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjZW5lJyk7XG5cdFx0XHR2YXIgdHJhY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlJyk7XG5cdFx0XHR0cmFjay5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3RyYWNrJyk7XG5cdFx0XHR0cmFjay5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnTGluZScpO1xuXHRcdFx0ZG9jLmFwcGVuZENoaWxkKHRyYWNrKTtcblxuXHRcdFx0YXBwLnJlbmRlcihtX3NoaXBzKTtcblxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGFwcC5zaW11bGF0ZSgpO1xuXHRcdFx0fSwgMTAwMDApO1xuXHRcdFx0Ly8gY2FsbCBmdW5jdGlvbiB0byB3YWl0IGEgYml0IGJlZm9yZSBzdGFydGluZyBzaW11bGF0aW9uXG5cdFx0XHQvL2FwcC5zaW11bGF0ZSgpO1xuXHRcdH0sXG5cblx0XHRwcmVwcm9jZXNzOiAoZGF0YSkgPT4ge1xuXHRcdFx0dmFyIHRyYW5zbGF0ZSA9IChkKSA9PiB7XG5cdFx0XHRcdHZhciByZXMgPSBkO1xuXHRcdFx0XHRpZiAocmVzLmhhc093blByb3BlcnR5KFwiYXRYXCIpICYmIHJlcy5oYXNPd25Qcm9wZXJ0eShcImF0WVwiKSkge1xuXHRcdFx0XHRcdHJlc1snYXRYJ10gPSA0KmQuYXRYO1xuXHRcdFx0XHRcdHJlc1snYXRaJ10gPSA0KmQuYXRZOyAvLyBtYWtlIHN1cmUgdG8gbW92ZSB0aGUgeSBwcm9wZXJ0eSBiZWZvcmUgb3ZlcnJpZGluZyBpdFxuXHRcdFx0XHRcdHJlc1snYXRZJ10gPSBtX0NvbnN0YW50cy5TaGlwWU9mZnNldDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXMueCA9IDQqZC54O1xuXHRcdFx0XHRyZXMueiA9IDQqZC55OyAvLyBtYWtlIHN1cmUgdG8gbW92ZSB0aGUgeSBwcm9wZXJ0eSBiZWZvcmUgb3ZlcnJpZGluZyBpdFxuXHRcdFx0XHRyZXMueSA9IG1fQ29uc3RhbnRzLlNoaXBZT2Zmc2V0O1xuXHRcdFx0XHRyZXR1cm4gcmVzO1xuXHRcdFx0fTtcblx0XHRcdHZhciBhY3Rpb25zID0gW107XG5cdFx0XHR2YXIgaW5kZXggPSAwO1xuXG5cdFx0XHQvLyBwcmVwcm9jZXNzIGluaXRpYWwgbWFwIGluZm9ybWF0aW9uXG5cdFx0XHQvLyBtX29jZWFuID0geyBcInhcIjogKCg0Kk1hdGguZmxvb3IoZGF0YS5vY2Vhbi54LzIpKS0yKSArIChtX0NvbnN0YW50cy5PY2VhblBhZGRpbmcvMiksXG5cdFx0XHQvLyAgICAgICAgICAgICBcInlcIjogbV9Db25zdGFudHMuT2NlYW5ZT2Zmc2V0LCBcblx0XHRcdC8vICAgICAgICAgICAgIFwielwiOiAoKDQqTWF0aC5mbG9vcihkYXRhLm9jZWFuLnkvMikpKSArIChtX0NvbnN0YW50cy5PY2VhblBhZGRpbmcvMiksIFxuXHRcdFx0Ly8gICAgICAgICAgICAgXCJ3aWR0aFwiOiAoNCpkYXRhLm9jZWFuLngpK21fQ29uc3RhbnRzLk9jZWFuUGFkZGluZywgXG5cdFx0XHQvLyAgICAgICAgICAgICBcImRlcHRoXCI6ICg0KmRhdGEub2NlYW4ueSkrbV9Db25zdGFudHMuT2NlYW5QYWRkaW5nLCBcblx0XHRcdC8vICAgICAgICAgICAgIFwiZGVuc2l0eVwiOiBNYXRoLm1pbigzKmRhdGEub2NlYW4ueCwgMypkYXRhLm9jZWFuLnkpK21fQ29uc3RhbnRzLk9jZWFuUGFkZGluZ1xuXHRcdFx0Ly8gICAgICAgICB9O1xuXHRcdFx0bV9vY2VhbiA9IHsgXCJ4XCI6ICgoNCpNYXRoLmZsb29yKGRhdGEub2NlYW4ueC8yKSktMiksXG5cdFx0XHRcdFx0XHRcInlcIjogbV9Db25zdGFudHMuT2NlYW5ZT2Zmc2V0LCBcblx0XHRcdFx0XHRcdFwielwiOiAoKDQqTWF0aC5mbG9vcihkYXRhLm9jZWFuLnkvMikpKSxcblx0XHRcdFx0XHRcdFwid2lkdGhcIjogMjAwLCBcblx0XHRcdFx0XHRcdFwiZGVwdGhcIjogMjAwLFxuXHRcdFx0XHRcdFx0XCJkZW5zaXR5XCI6IDEyMCxcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0XHRcdC8vIHByZXByb2Nlc3MgaW5pdGlhbCBzaGlwIGluZm9ybWF0aW9uXG5cdFx0XHRkYXRhLnNoaXBzLmZvckVhY2goKGVudHJ5KSA9PiB7XG5cdFx0XHRcdG1fc2hpcHMucHVzaCh0cmFuc2xhdGUoZW50cnkpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBwcmVwcm9jZXNzIGFjdGlvbnMgYW5kIHR1cm5zIGluZm9ybWF0aW9uXG5cdFx0XHR3aGlsZShpbmRleCA8IGRhdGEudHVybnMubGVuZ3RoKSB7XG5cdFx0XHRcdHZhciBjaGFpbiA9IHRydWU7XG5cdFx0XHRcdHdoaWxlKGNoYWluKSB7XG5cdFx0XHRcdFx0aWYgKGluZGV4ID09PSBkYXRhLnR1cm5zLmxlbmd0aClcblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0aWYgKGFjdGlvbnMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0XHRhY3Rpb25zLnB1c2godHJhbnNsYXRlKGRhdGEudHVybnNbaW5kZXhdKSk7XG5cdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBTaGlwIGlkIGFuZCBhY3Rpb24gdHlwZSBoYXMgdG8gYmUgdGhlIHNhbWUgdG8gYmUgY29uc2lkZXJlZCBhIGNoYWluLWFibGUgYWN0aW9uXG5cdFx0XHRcdFx0ZWxzZSBpZiAoYWN0aW9uc1swXS5pZCA9PT0gZGF0YS50dXJuc1tpbmRleF0uaWQgJiYgYWN0aW9uc1swXS50eXBlID09PSBkYXRhLnR1cm5zW2luZGV4XS50eXBlKSB7XG5cdFx0XHRcdFx0XHRpZiAoYWN0aW9uc1swXS50eXBlID09PSBcIk1PVkVcIikge1xuXHRcdFx0XHRcdFx0XHRhY3Rpb25zLnB1c2godHJhbnNsYXRlKGRhdGEudHVybnNbaW5kZXhdKSk7XG5cdFx0XHRcdFx0XHRcdGluZGV4Kys7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQvLyBGaXJpbmcgbXVzdCBiZSBhdCB0aGUgc2FtZSBjb29yZGluYXRlcyB0byBiZSBjb25zaWRlcmVkIGEgY2hhaW4tYWJsZSBhY3Rpb25cblx0XHRcdFx0XHRcdGVsc2UgaWYgKGFjdGlvbnNbMF0udHlwZSA9PT0gXCJGSVJFXCIgJiYgYWN0aW9uc1swXS5hdFggPT09IDQqKGRhdGEudHVybnNbaW5kZXhdLmF0WCkgJiYgYWN0aW9uc1swXS5hdFkgPT09IDQqKGRhdGEudHVybnNbaW5kZXhdLmF0WSkpIHtcblx0XHRcdFx0XHRcdFx0YWN0aW9ucy5wdXNoKHRyYW5zbGF0ZShkYXRhLnR1cm5zW2luZGV4XSkpO1xuXHRcdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZWxzZSBpZihhY3Rpb25zWzBdLnR5cGUgPT09IFwiU0lOS1wiKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbnMucHVzaCh0cmFuc2xhdGUoZGF0YS50dXJuc1tpbmRleF0pKTtcblx0XHRcdFx0XHRcdFx0aW5kZXgrKztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRjaGFpbiA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdGNoYWluID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIGFkZCBhY3Rpb24gY2hhaW4gdG8gdmFyaWFibGVcblx0XHRcdFx0bV9jaGFpbi5wdXNoKHtcInR5cGVcIjogYWN0aW9uc1swXS50eXBlLCBcImFjdGlvbnNcIjogYWN0aW9uc30pO1xuXHRcdFx0XHQvLyByZXNldCBjaGFpbiBhY3Rpb25zXG5cdFx0XHRcdGFjdGlvbnMgPSBbXTtcblx0XHRcdH1cblx0XHRcdGNvbnNvbGUubG9nKG1fY2hhaW4pO1xuXHRcdH0sXG5cblxuXG5cdFx0Ly8gRGlzcGxheXMgdGhlIG9jZWFuLCBhbmQgc2hpcHNcblx0XHQvLyBUT0RPOiBjaGVjayB0aGUgZWRnZSBjYXNlcyB3aXRoIHRoZSBtYXAgZWRnZXMvc2l6ZXNcblx0XHRyZW5kZXI6IChzaGlwRGF0YSkgPT4ge1xuXHRcdFx0dmFyIGRvYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpOyAvLyA8YS1zY2VuZT4gcmVmZXJlbmNlXG5cblx0XHRcdC8vIHJlLXBvc2l0aW9uIGNhbWVyYTogY2FtZXJhIG11c3QgYmUgYWxyZWFkeSBwcmVzZW50IHdoZW4gaHRtbCBsb2Fkc1xuXHRcdFx0dmFyIGNhbWVyYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW1lcmEnKTtcblx0XHRcdC8vY2FtZXJhLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBtX29jZWFuLnggKyBcIiBcIiArIG1fb2NlYW4ueSArIFwiIFwiICsgbV9vY2Vhbi56KTtcblx0XHRcdGNhbWVyYS5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgbV9vY2Vhbi54ICsgXCIgXCIgKyBtX29jZWFuLnkgKyBcIiBcIiArIChtX29jZWFuLnorKDEuNSptX29jZWFuLngpKSk7XG5cdFx0XHRjYW1lcmEuc2V0QXR0cmlidXRlKCdjYW1lcmEnLCAndXNlckhlaWdodDogJyArIG1fQ29uc3RhbnRzLkNhbWVyYVlPZmZzZXQpO1xuXHRcdFx0Y2FtZXJhLnNldEF0dHJpYnV0ZSgncm90YXRpb24nLCAtTWF0aC5hdGFuKG1fQ29uc3RhbnRzLkNhbWVyYVlPZmZzZXQvKG1fb2NlYW4ueittX29jZWFuLngpKSk7XG5cblx0XHRcdC8vIEdlbmVyYXRlIE1hcFxuXHRcdFx0Ly8gVE9ETzogUG9zc2libGUgZWRnZSBjYXNlcyB3aXRoIHRoZSBtYXAgZWRnZSBub3QgYmVpbmcgYmlnIGVub3VnaFxuXHRcdFx0dmFyIG1hcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Etb2NlYW4nKTtcblxuXHRcdFx0bWFwLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBtX29jZWFuLnggKyBcIiBcIiArIG1fb2NlYW4ueSArIFwiIFwiICsgbV9vY2Vhbi56KTtcblx0XHRcdG1hcC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgU3RyaW5nKG1fb2NlYW4ud2lkdGgpKTtcblx0XHRcdG1hcC5zZXRBdHRyaWJ1dGUoJ2RlcHRoJywgU3RyaW5nKG1fb2NlYW4uZGVwdGgpKTtcblx0XHRcdG1hcC5zZXRBdHRyaWJ1dGUoJ2RlbnNpdHknLCBTdHJpbmcobV9vY2Vhbi5kZW5zaXR5KSk7XG5cdFx0XHRkb2MuYXBwZW5kQ2hpbGQobWFwKTtcblxuXHRcdFx0Ly8gU3Bhd24gU2hpcHNcblx0XHRcdHNoaXBEYXRhLmZvckVhY2goKGVudHJ5KSA9PiB7XG5cdFx0XHRcdHZhciBzaGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1lbnRpdHknKTtcblxuXHRcdFx0XHRzaGlwLmRhdGFzZXQuaWQgPSBlbnRyeS5pZDtcblx0XHRcdFx0c2hpcC5kYXRhc2V0Lm5hbWUgPSBlbnRyeS5uYW1lO1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQub3duZXIgPSBlbnRyeS5vd25lcjtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LnggPSBlbnRyeS54O1xuXHRcdFx0XHRzaGlwLmRhdGFzZXQueSA9IGVudHJ5Lnk7XG5cdFx0XHRcdHNoaXAuZGF0YXNldC56ID0gZW50cnkuejtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LmhlYWx0aCA9IGVudHJ5Lmh1bGw7XG5cdFx0XHRcdHNoaXAuZGF0YXNldC5odWxsID0gZW50cnkuaHVsbDtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LmZpcmVwb3dlciA9IGVudHJ5LmZpcmVwb3dlcjtcblx0XHRcdFx0c2hpcC5kYXRhc2V0LnNwZWVkID0gZW50cnkuc3BlZWQ7XG5cdFx0XHRcdHNoaXAuZGF0YXNldC5yYW5nZSA9IGVudHJ5LnJhbmdlO1xuXG5cdFx0XHRcdHZhciBoZWFydCA9IFwiXCI7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcGFyc2VJbnQoZW50cnkuaHVsbCk7IGkrKykge1xuXHRcdFx0XHRcdGhlYXJ0ICs9IFwiIOKAolwiO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgZW50cnkueCArIFwiIFwiICsgZW50cnkueSArIFwiIFwiICsgZW50cnkueik7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCd0ZW1wbGF0ZScsICdzcmM6ICNib2F0LXRlbXBsYXRlJyk7XG5cdFx0XHRcdHNoaXAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdib2F0Jyk7XG5cdFx0XHRcdC8vICR7dmFyaWFibGV9IDwtIHZhcmlhYmxlIG5hbWUgYmUgbG93ZXIgY2FzZVxuXHRcdFx0XHRzaGlwLnNldEF0dHJpYnV0ZSgnZGF0YS1zaGlwX2NvbG9yJywgJ2NvbG9yOiAnK2VudHJ5LmNvbG9yKyc7IG1ldGFsbmVzczogMC40OycpO1xuXHRcdFx0XHRzaGlwLnNldEF0dHJpYnV0ZSgnZGF0YS1zaGlwX25hbWUnLCAndmFsdWU6ICcrZW50cnkubmFtZSsnOyBmb250OiAjcGxheTsnKTtcblx0XHRcdFx0c2hpcC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2hpcF9oZWFsdGgnLCAndmFsdWU6ICcraGVhcnQrJzsnKTtcblxuXHRcdFx0XHR2YXIgc2hpcEluc3RhbmNlID0gZG9jLmFwcGVuZENoaWxkKHNoaXApO1xuXHRcdFx0XHRtX2VudGl0eVtlbnRyeS5pZF0gPSBzaGlwSW5zdGFuY2U7XG5cdFx0XHR9KTtcblxuXHRcdH0sXG5cblx0XHRzaW5rU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwRG9tID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0dmFyIGRlYnVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnY3VydmVyZWYnLCAnI3RyYWNrJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyOiBsaW5lOyBjb2xvcjogYmxhY2s7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0dmFyIHBvaW50MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0dmFyIHBvaW50MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0cG9pbnQxLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIGRhdGFbMF0ueSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0cG9pbnQyLnNldEF0dHJpYnV0ZSgncG9zaXRpb24nLCBkYXRhWzBdLnggKyBcIiBcIiArIChkYXRhWzBdLnktbV9Db25zdGFudHMuU2lua0Rpc3RhbmNlKSArIFwiIFwiICsgZGF0YVswXS56KTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQxKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQyKTtcblxuXHRcdFx0XHRzaGlwRG9tLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogdHJ1ZTsgY29uc3RyYWludDogMCAxIDA7IGRlbGF5OiAnK21fQ29uc3RhbnRzLldhaXRUaW1lQmV0d2VlbkFjdGlvbisnOyBkdXI6IDMwMDA7Jyk7XG5cblx0XHRcdFx0dmFyIGRvbmUgPSAoZXZlbnQpID0+IHtcblx0XHRcdFx0XHRzaGlwRG9tLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0aWYgKGRlYnVnLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChkZWJ1Zyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0d2hpbGUodHJhY2suaGFzQ2hpbGROb2RlcygpKSB7XG5cdFx0XHRcdFx0XHR0cmFjay5yZW1vdmVDaGlsZCh0cmFjay5jaGlsZE5vZGVzWzBdKTtcblx0XHRcdFx0XHR9XG5cblxuXHRcdFx0XHRcdC8vc2hpcERvbS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXG5cdFx0XHRcdFx0aWYgKHNoaXBEb20ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0ZG9jLnJlbW92ZUNoaWxkKHNoaXBEb20pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHNoaXBEb20uYWRkRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblx0XHRcdFx0Ly8gcmVzb2x2ZSgpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8vIERhdGEgcGFzc2VkIGluIGFyZSBvbmUgc2hpcHMgYWN0aW9uIG9mIGZpcmluZyBhdCBvbmUgYW5kIG9ubHkgb25lIGNvb3JkaW5hdGVcblx0XHRmaXJlU2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NlbmUnKTtcblx0XHRcdFx0dmFyIHRyYWNrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyYWNrJyk7XG5cdFx0XHRcdHZhciBzaGlwID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cblx0XHRcdFx0Ly8gdmFyIGJ1bGxldCA9IFtdOyAvLyBsaXN0IGltcGxlbWVudGF0aW9uIGFsbG93cyBhZGRpdGlvbiBvZiBmZWF0dXJlcyBpbiB0aGUgZnV0dXJlXG5cdFx0XHRcdC8vIGlmIChzaGlwLmNsYXNzTmFtZSA9PT0gXCJib2F0XCIpIHtcblx0XHRcdFx0Ly8gXHRmb3IgKHZhciBpID0gMDsgaSA8IHNoaXAuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRcdC8vIFx0fVxuXHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0dmFyIGJ1bGxldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Etc3BoZXJlJyk7XG5cdFx0XHRcdHZhciBzb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdHZhciBhcmMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhLWN1cnZlLXBvaW50Jyk7XG5cdFx0XHRcdGJ1bGxldC5zZXRBdHRyaWJ1dGUoJ2NvbG9yJywgJ2dyYXknKTtcblx0XHRcdFx0YnVsbGV0LnNldEF0dHJpYnV0ZSgncmFkaXVzJywgJzAuMScpO1xuXHRcdFx0XHRidWxsZXQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGFbMF0ueCArIFwiIFwiICsgZGF0YVswXS55ICsgXCIgXCIgKyBkYXRhWzBdLnopO1xuXHRcdFx0XHRzb3VyY2Uuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGFbMF0ueCArIFwiIFwiICsgZGF0YVswXS55ICsgXCIgXCIgKyBkYXRhWzBdLnopO1xuXHRcdFx0XHR0YXJnZXQuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIGRhdGFbMF0uYXRYICsgXCIgXCIgKyBkYXRhWzBdLmF0WSArIFwiIFwiICsgZGF0YVswXS5hdFopO1xuXHRcdFx0XHRhcmMuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIChkYXRhWzBdLmF0WCtkYXRhWzBdLngpLzIgKyBcIiBcIiArICgoKGRhdGFbMF0uYXRZK2RhdGFbMF0ueSkvMikrbV9Db25zdGFudHMuQnVsbGV0QXJjKSArIFwiIFwiICsgKGRhdGFbMF0uYXRaK2RhdGFbMF0ueikvMik7XG5cdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKHNvdXJjZSk7XG5cdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKGFyYyk7XG5cdFx0XHRcdHRyYWNrLmFwcGVuZENoaWxkKHRhcmdldCk7XG5cblx0XHRcdFx0dmFyIGRlYnVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnY3VydmVyZWYnLCAnI3RyYWNrJyk7XG5cdFx0XHRcdGRlYnVnLnNldEF0dHJpYnV0ZSgnbWF0ZXJpYWwnLCAnc2hhZGVyOiBsaW5lOyBjb2xvcjogcmVkOycpO1xuXHRcdFx0XHRkb2MuYXBwZW5kQ2hpbGQoZGVidWcpO1xuXG5cdFx0XHRcdHZhciB0bXAgPSBkb2MuYXBwZW5kQ2hpbGQoYnVsbGV0KTtcblx0XHRcdFx0dG1wLnNldEF0dHJpYnV0ZSgnYWxvbmdwYXRoJywgJ2N1cnZlOiAjdHJhY2s7IHJvdGF0ZTogdHJ1ZTsgY29uc3RhbnQ6IDAgMCAxOyBkZWxheTogMjAwOyBkdXI6IDUwMCcpO1xuXG5cdFx0XHRcdHZhciBkb25lID0gKGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0dG1wLnJlbW92ZUF0dHJpYnV0ZSgnYWxvbmdwYXRoJyk7XG5cdFx0XHRcdFx0aWYgKGRlYnVnLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChkZWJ1Zyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHdoaWxlKHRyYWNrLmhhc0NoaWxkTm9kZXMoKSkge1xuXHRcdFx0XHRcdFx0dHJhY2sucmVtb3ZlQ2hpbGQodHJhY2suY2hpbGROb2Rlc1swXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIHZhciBhY3Rpb24gPSBudWxsO1xuXHRcdFx0XHRcdC8vIGlmIChzaGlwLmNsYXNzTmFtZSA9PSBcImJvYXRcIikge1xuXHRcdFx0XHRcdC8vIFx0Zm9yKHZhciBpID0gMDsgaSA8IHNoaXAuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdC8vIFx0XHRpZiAoc2hpcC5jaGlsZE5vZGVzW2ldLmNsYXNzTmFtZSA9PT0gXCJhaW1TaGlwXCIpIHtcblx0XHRcdFx0XHQvLyBcdFx0XHRhY3Rpb24gPSBzaGlwLmNoaWxkTm9kZXNbaV07XG5cdFx0XHRcdFx0Ly8gXHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Ly8gXHRcdH1cblx0XHRcdFx0XHQvLyBcdH1cblx0XHRcdFx0XHQvLyBcdGlmIChhY3Rpb24pIHtcblx0XHRcdFx0XHQvLyBcdFx0Ly9hY3Rpb24ucmVtb3ZlQXR0cmlidXRlKCdsb29rLWF0Jyk7XG5cdFx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdFx0Ly8gfVxuXG5cdFx0XHRcdFx0Ly90bXAucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW92aW5nZW5kZWQnLCBkb25lKTtcblx0XHRcdFx0XHRpZiAodG1wLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZCh0bXApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXNvbHZlKGV2ZW50KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRtcC5hZGRFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXHRcdFx0XHQvL3Jlc29sdmUoKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRhaW1TaGlwOiAoZGF0YSkgPT4ge1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ2FpbSBpbmZvOiAnLCBkYXRhKTtcblx0XHRcdFx0dmFyIGRvYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpO1xuXHRcdFx0XHR2YXIgdHJhY2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJhY2snKTtcblx0XHRcdFx0dmFyIHNoaXAgPSBtX2VudGl0eVtkYXRhWzBdLmlkXTtcblxuXHRcdFx0XHR2YXIgYWN0aW9uID0gbnVsbDtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJjbGFzc05hbWVcIiwgc2hpcC5jbGFzc05hbWUpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhzaGlwKTtcblx0XHRcdFx0aWYgKHNoaXAuY2xhc3NOYW1lID09IFwiYm9hdFwiKSB7XG5cdFx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNoaXAuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0aWYgKHNoaXAuY2hpbGROb2Rlc1tpXS5jbGFzc05hbWUgPT09IFwiYWltU2hpcFwiKSB7XG5cdFx0XHRcdFx0XHRcdGFjdGlvbiA9IHNoaXAuY2hpbGROb2Rlc1tpXTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChhY3Rpb24pIHtcblx0XHRcdFx0XHRcdHZhciBjdXJyZW50ID0gYWN0aW9uLmdldEF0dHJpYnV0ZShcInJvdGF0aW9uXCIpLnk7XG5cdFx0XHRcdFx0XHR2YXIgcmFkaWFuID0gTWF0aC5hdGFuKChkYXRhWzBdLmF0Wi1kYXRhWzBdLnopLyhkYXRhWzBdLmF0WC1kYXRhWzBdLngpKTtcblx0XHRcdFx0XHRcdHZhciBkZWdyZWUgPSByYWRpYW4gKiAxODAgLyBNYXRoLlBJO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRhY3Rpb24uc2V0QXR0cmlidXRlKCdsb29rLWF0JywgZGF0YVswXS5hdFggKyAnICcgKyBkYXRhWzBdLmF0WSArICcgJyArIGRhdGFbMF0ueik7XG5cblx0XHRcdFx0XHRcdC8vY29uc29sZS5sb2coJ2N1cnJlbnQtcm90YXRpb246ICcsIGN1cnJlbnQpO1xuXG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCdkZWx0YS1yb3RhdGlvbjogJywgcmFkaWFuLCBkZWdyZWUpO1xuXHRcdFx0XHRcdFx0Ly9hY3Rpb24uc2V0QXR0cmlidXRlKClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYWN0aW9uKSB7XG5cdFx0XHRcdFx0YWN0aW9uLnJlbW92ZUF0dHJpYnV0ZSgnbG9vay1hdCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJlc29sdmUoKTtcdFx0XHRcdFxuXHRcdFx0fSk7XG5cblx0XHR9LFxuXG5cdFx0aGl0U2hpcDogKGRhdGEpID0+IHtcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRcdHZhciBzaGlwID0gbV9lbnRpdHlbZGF0YVswXS5pZF07XG5cdFx0XHRcdHZhciBoZWFydCA9IFwiXCI7XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhWzBdLmhlYWx0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aGVhcnQgKz0gXCIg4oCiXCI7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNoaXAuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChzaGlwLmNoaWxkTm9kZXNbaV0uY2xhc3NOYW1lID09IFwic2hpcC1oZWFsdGhcIikge1xuXHRcdFx0XHRcdFx0c2hpcC5jaGlsZE5vZGVzW2ldLnNldEF0dHJpYnV0ZSgndGV4dC1nZW9tZXRyeScsICd2YWx1ZTogJytoZWFydCsnOycpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8vIERhdGEgcGFzc2VkIGluIG11c3QgYmUgZm9yIG1vdmVtZW50IG9mIG9uZSBzaGlwXG5cdFx0bW92ZVNoaXA6IChkYXRhKSA9PiB7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHR2YXIgc2hpcERvbSA9IG1fZW50aXR5W2RhdGFbMF0uaWRdOyAvLyBodG1sIGVsZW1lbnRcblx0XHRcdFx0Ly8gaWYgc3RhdGVtZW50IGlzIG5vdCB3b3JraW5nXG5cdFx0XHRcdC8vIGlmIChkYXRhLmxlbmd0aCA9PT0gMSAmJiBkYXRhWzBdLnggPT09IHNoaXBEb20uZGF0YXNldC54ICYmIGRhdGFbMF0ueiA9PT0gc2hpcERvbS5kYXRhc2V0LnopIHtcblx0XHRcdFx0Ly8gICAgIC8vIGlmIHNoaXBEb20gdHJpZXMgdG8gbW92ZSBhZ2FpbnN0IGVkZ2Ugb3Igb2NjdXBpZWQgcGxhY2Vcblx0XHRcdFx0Ly8gICAgIGFsZXJ0KFwiU2tpcHBlZFwiKTtcblx0XHRcdFx0Ly8gICAgIHJlc29sdmUoXCJTa2lwcGVkXCIpO1xuXHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0dmFyIGRvYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2VuZScpOyAvLyA8YS1zY2VuZT4gcmVmZXJlbmNlXG5cdFx0XHRcdHZhciB0cmFjayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmFjaycpO1xuXHRcdFx0XHQvL3ZhciBzdGFydENvb3JkID0ge1wieFwiOiBkYXRhWzBdLnh9O1xuXG5cdFx0XHRcdHZhciBkZWJ1ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtZHJhdy1jdXJ2ZScpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ2N1cnZlcmVmJywgJyN0cmFjaycpO1xuXHRcdFx0XHRkZWJ1Zy5zZXRBdHRyaWJ1dGUoJ21hdGVyaWFsJywgJ3NoYWRlcjogbGluZTsgY29sb3I6IGJsdWU7Jyk7XG5cdFx0XHRcdGRvYy5hcHBlbmRDaGlsZChkZWJ1Zyk7XG5cblx0XHRcdFx0Ly8gYWRkIGN1cnJlbnQgbG9jYXRpb24gYXMgYSBzdGFydGluZyBwb2ludCBvZiB0aGUgY3VydmVcblx0XHRcdFx0dmFyIHBvaW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYS1jdXJ2ZS1wb2ludCcpO1xuXHRcdFx0XHRwb2ludC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgU3RyaW5nKHNoaXBEb20uZGF0YXNldC54ICsgXCIgXCIgKyBzaGlwRG9tLmRhdGFzZXQueSArIFwiIFwiICsgc2hpcERvbS5kYXRhc2V0LnopKTtcblx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQpO1xuXHRcdFx0XHQvLyBhZGQgY2hhaW4tYWJsZSBnb2FsIGxvY2F0aW9ucyB0byB0aGUgY3VydmVcblx0XHRcdFx0XG5cdFx0XHRcdC8vcHJldmlvdXMgaXMgdXNlZCB0byBjaGVjayBmb3IgbW92ZW1lbnQgYWdhaW5zdCB3YWxscywgZS5nLiBwcmV2aW91cyBsb2NhdGlvbiBzYW1lIGFzIGN1cnJlbnQgYW5kIG5leHRcblx0XHRcdFx0Ly9wcmV2aW91cyBjYW4gYWxzbyBiZSB1c2VkIHRvIGdldCB0aGUgbGFzdCBhY3Rpb24gd2hpY2ggZGV0ZXJtaW5lcyB0aGUgZmluYWwgcm90YXRpb24gd2hlcmUgdGhlIHNoaXAgc2hvdWxkIHBvaW50XG5cdFx0XHRcdHZhciBwcmV2aW91cyA9IHsneCc6IHNoaXBEb20uZGF0YXNldC54LCAneic6IHNoaXBEb20uZGF0YXNldC56fTtcblx0XHRcdFx0dmFyIHhEaXN0YW5jZSA9IDA7XG5cdFx0XHRcdHZhciB6RGlzdGFuY2UgPSAwO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIk1vdmluZzogXCIsIGRhdGEpO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRwb2ludCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EtY3VydmUtcG9pbnQnKTtcblx0XHRcdFx0XHRwb2ludC5zZXRBdHRyaWJ1dGUoJ3Bvc2l0aW9uJywgZGF0YVtpXS54ICsgXCIgXCIgKyBkYXRhW2ldLnkgKyBcIiBcIiArIGRhdGFbaV0ueik7XG5cdFx0XHRcdFx0eERpc3RhbmNlICs9IE1hdGguYWJzKGRhdGFbaV0ueCAtIHByZXZpb3VzLngpO1xuXHRcdFx0XHRcdHpEaXN0YW5jZSArPSBNYXRoLmFicyhkYXRhW2ldLnogLSBwcmV2aW91cy56KTtcblx0XHRcdFx0XHRpZiAoaSArIDEgPCBkYXRhLmxlbmd0aCAmJiBkYXRhW2ldLnggPT09IGRhdGFbaSsxXS54ICYmIGRhdGFbaV0ueiA9PT0gZGF0YVtpKzFdLnopIHtcblx0XHRcdFx0XHRcdGkrKztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dHJhY2suYXBwZW5kQ2hpbGQocG9pbnQpO1xuXHRcdFx0XHRcdHByZXZpb3VzID0geyd4JzogZGF0YVtpXS54LCAneic6IGRhdGFbaV0ueiwgJ2RpcmVjdGlvbic6IGRhdGFbaV0uZGlyZWN0aW9ufTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcImV2ZXJ5dGhpbmdcIiwgZGF0YSk7XG5cdFx0XHRcdC8vIHZhciByb3RhdGlvblkgPSA0NTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coJ2VuZCBkaXJlY3Rpb24nLCBwcmV2aW91cy5kaXJlY3Rpb24pO1xuXHRcdFx0XHQvLyBpZiAocHJldmlvdXMuZGlyZWN0aW9uID09ICdOb3J0aCcpIFxuXHRcdFx0XHQvLyBcdHJvdGF0aW9uWSA9IDA7XG5cdFx0XHRcdC8vIGVsc2UgaWYgKHByZXZpb3VzLmRpcmVjdGlvbiA9PSAnV2VzdCcpXG5cdFx0XHRcdC8vIFx0cm90YXRpb25ZID0gOTA7XG5cdFx0XHRcdC8vIGVsc2UgaWYgKHByZXZpb3VzLmRpcmVjdGlvbiA9PSAnU291dGgnKVxuXHRcdFx0XHQvLyBcdHJvdGF0aW9uWSA9IDE4MDtcblx0XHRcdFx0Ly8gZWxzZSBpZiAocHJldmlvdXMuZGlyZWN0aW9uID09ICdFYXN0Jylcblx0XHRcdFx0Ly8gXHRyb3RhdGlvblkgPSAyNzA7XG5cdFx0XHRcdC8vIGVsc2UgXG5cdFx0XHRcdC8vIFx0cm90YXRpb25ZID0gMjk1O1xuXHRcdFx0XHRcblxuXHRcdFx0XHR2YXIgZHVyID0gKHhEaXN0YW5jZSt6RGlzdGFuY2UpKm1fQ29uc3RhbnRzLldhaXRUaW1lUGVyVGlsZU1vdmVkOyAvLyBkZXRlcm1pbmVzIHRoZSBsZW5ndGggaW4gdGltZSBvZiB0aGUgbW92ZW1lbnQgXG5cdFx0XHRcdHNoaXBEb20uc2V0QXR0cmlidXRlKCdhbG9uZ3BhdGgnLCAnY3VydmU6ICN0cmFjazsgcm90YXRlOiB0cnVlOyBjb25zdHJhaW50OiAwIDAgMTsgZGVsYXk6ICcrbV9Db25zdGFudHMuV2FpdFRpbWVCZXR3ZWVuQWN0aW9uKyc7IGR1cjogJytkdXIrJzsnKTtcblxuXHRcdFx0XHR2YXIgZG9uZSA9IChldmVudCkgPT4ge1xuXHRcdFx0XHRcdC8vIHZhciBsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5VGFnTmFtZSgnYS1kcmF3LWN1cnZlJyk7XG5cdFx0XHRcdFx0Ly8gZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Ly8gICAgIGxpc3RbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsaXN0WzBdKTtcblx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdFx0aWYgKGRlYnVnLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdGRvYy5yZW1vdmVDaGlsZChkZWJ1Zyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0d2hpbGUodHJhY2suaGFzQ2hpbGROb2RlcygpKSB7XG5cdFx0XHRcdFx0XHR0cmFjay5yZW1vdmVDaGlsZCh0cmFjay5jaGlsZE5vZGVzWzBdKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0c2hpcERvbS5yZW1vdmVBdHRyaWJ1dGUoJ2Fsb25ncGF0aCcpO1xuXHRcdFx0XHRcdHNoaXBEb20uZGF0YXNldC54ID0gZGF0YVtkYXRhLmxlbmd0aC0xXS54O1xuXHRcdFx0XHRcdHNoaXBEb20uZGF0YXNldC56ID0gZGF0YVtkYXRhLmxlbmd0aC0xXS56O1xuXHRcdFx0XHRcdHNoaXBEb20uZGF0YXNldC55ID0gZGF0YVtkYXRhLmxlbmd0aC0xXS55O1xuXG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZygnZW5kIHBhdGgnLCByb3RhdGlvblkpO1xuXHRcdFx0XHRcdC8vc2hpcERvbS5zZXRBdHRyaWJ1dGUoJ3JvdGF0aW9uJywgJzAgJyArIHJvdGF0aW9uWSArICcgMCcpO1xuXG5cdFx0XHRcdFx0Ly9zaGlwRG9tLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdmluZ2VuZGVkJywgZG9uZSk7XG5cdFx0XHRcdFx0cmVzb2x2ZShldmVudCk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0c2hpcERvbS5hZGRFdmVudExpc3RlbmVyKCdtb3ZpbmdlbmRlZCcsIGRvbmUpO1xuXG5cdFx0XHRcdFxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHNpbXVsYXRlOiAoKSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImNoYWluOiBcIiwgbV9jaGFpbik7XG5cdFx0XHR2YXIgbm90U3RvcCA9IHRydWU7XG5cdFx0XHRpZiAobV9jaGFpbi5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRub3RTdG9wID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR2YXIgY3VycmVudCA9IG1fY2hhaW4uc2hpZnQoKTsgLy8gZG9uJ3Qgc2hpZnQgd2hlbiBsZW5ndGggaXMgemVyb1xuXHRcdFx0aWYgKGN1cnJlbnQgJiYgbm90U3RvcCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcImN1cnJlbnQ6IFwiLCBjdXJyZW50KTtcblx0XHRcdFx0c3dpdGNoKGN1cnJlbnQudHlwZSkge1xuXHRcdFx0XHRcdGNhc2UgXCJNT1ZFXCI6XG5cdFx0XHRcdFx0XHRhcHAubW92ZVNoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vYWxlcnQoXCJNb3ZlZCBcIiArIG1fY2hhaW4ubGVuZ3RoICsgXCIgYWN0aW9ucyBsZWZ0XCIpO1xuXHRcdFx0XHRcdFx0XHRhcHAuc2ltdWxhdGUoKTtcblx0XHRcdFx0XHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIFwiRklSRVwiOlxuXHRcdFx0XHRcdFx0YXBwLmFpbVNoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cblx0XHRcdFx0XHRcdFx0YXBwLmZpcmVTaGlwKGN1cnJlbnQuYWN0aW9ucykudGhlbigoZG9uZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdGFwcC5zaW11bGF0ZSgpO1xuXHRcdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcImVycm9yOiBcIiwgZXJyKTtcdFxuXHRcdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0fSkuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiZXJyb3I6IFwiLCBlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIFwiSElUXCI6XG5cdFx0XHRcdFx0XHRhcHAuaGl0U2hpcChjdXJyZW50LmFjdGlvbnMpLnRoZW4oKGRvbmUpID0+IHtcblx0XHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJTSU5LXCI6XG5cdFx0XHRcdFx0XHRhcHAuc2lua1NoaXAoY3VycmVudC5hY3Rpb25zKS50aGVuKChkb25lKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vYWxlcnQoXCJTdW5rIFwiKyBtX2NoYWluLmxlbmd0aCArIFwiIGFjdGlvbnMgbGVmdFwiKTtcblx0XHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdFx0XHR9KS5jYXRjaCgoZXJyKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIlVua25vd24gQWN0aW9uIFR5cGUgXCIgKyBjdXJyZW50LnR5cGUgKyBcIiBpbiBzaW11bGF0ZSBmdW5jdGlvbiwgc2tpcHBpbmcuXCIpO1xuXHRcdFx0XHRcdFx0YXBwLnNpbXVsYXRlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdC8vYWxlcnQoXCJTaW11bGF0aW9uIERvbmVcIik7XG5cdFx0XHRcdFx0dmV4LmRpYWxvZy5hbGVydChcIlNpbXVsYXRpb24gQ29tcGxldGVkLlwiKTtcblx0XHRcdFx0fSwgMTAwMDApO1xuXHRcdFx0fVxuXG5cdFx0fSxcblxuXHRcdHJvdGF0ZVZlY3RvcjogKHZlYzMsIGRlZykgPT4ge1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcInhcIjogdmVjMy54ICogY29zKClcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqIHRyYW5zbGF0ZXMgdGhlIGNvb3JkaW5hdGUgaW4gdGhlIGphdmEgZ2FtZSB0byB0aGlzIHNjZW5lJ3MgY29vcmRpbmF0ZVxuXHRcdFx0SmF2YSBHYW1lOiBFYWNoIHNoaXAgc3BhbnMgb25lICh4LCB5KSB1bml0XG5cdFx0XHRKYXZhIEdhbWU6IENvb3JkaW5hdGUgc3lzdGVtIGhhcyAoMCwgMCkgYXQgdG9wIGxlZnQgY29ybmVyICh3aXRob3V0IG5lZ2F0aXZlcylcblx0XHRcdEFGcmFtZSBTY2VuZTogRWFjaCBzaGlwIG1vZGVsIGlzIGEgNHg0IGJveFxuXHRcdFx0QUZyYW1lIFNjZW5lOiBDb29yZGluYXRlIHN5c3RlbSBpcyAoMCwgMCkgYXQgdGhlIGNlbnRlciAod2l0aCBuZWdhdGl2ZXMpXG5cdFx0Ki9cblx0XHRnZXRTdHJDb29yZDogKGNvb3JkLCBvZmZzZXRZKSA9PiB7XG5cdFx0XHRyZXR1cm4gKG1fb2NlYW4ueC1jb29yZC54KSo0ICsgXCIgXCIgKyBvZmZzZXRZICsgXCIgXCIgKyAobV9vY2Vhbi55LWNvb3JkLnkpKjQ7XG5cdFx0fSxcblxuXHRcdGdldFNoaXBzOiAoKSA9PiB7XG5cdFx0XHRyZXR1cm4gbV9zaGlwcztcblx0XHR9LFxuXG5cdFx0Z2V0T2NlYW46ICgpID0+IHtcblx0XHRcdHJldHVybiBtX29jZWFuO1xuXHRcdH1cblxuXG5cdH1cblxuXHRyZXR1cm4gYXBwO1xufVxuXG52YXIgYXBwID0gYmF0dGxlc2hpcCgpO1xubGV0IHBhcmFtcyA9IGdldFF1ZXJ5UGFyYW1zKGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCk7XG5cbmxldCBnZXREYXRhRnJvbUNvZGUgPSAoY29kZSkgPT4ge1xuXHRkYi5yZWYoJ2Rhdnktam9uZXMtbG9ja2VyLycgKyBjb2RlKS5vbmNlKCd2YWx1ZScsIChzbmFwc2hvdCkgPT4ge1xuXHRcdHZhciBnYW1lRGF0YSA9IHNuYXBzaG90LnZhbCgpO1xuXHRcdGlmIChnYW1lRGF0YSkge1xuXHRcdFx0aW5wdXQgPSBnYW1lRGF0YTtcblx0XHRcdGFwcC5pbml0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGdldENvZGUoYE5vIGRhdGEgZm9yIGNvZGUgJHtjb2RlfS4gRW50ZXIgYW5vdGhlciBjb2RlOmApO1xuXHRcdFx0Ly9hcHAuaW5pdCgpO1xuXHRcdH1cblx0fSkuY2F0Y2goKGVycikgPT4ge1xuXHRcdGdldENvZGUoYFRoZXJlIHdhcyBhbiBlcnJvci4gRW50ZXIgYW5vdGhlciBjb2RlOmApO1xuXHRcdC8vYXBwLmluaXQoKTtcblx0fSk7XG59XG5cbmxldCBnZXRDb2RlID0gKG1lc3NhZ2UpID0+IHtcblx0dmV4LmRpYWxvZy5wcm9tcHQoe1xuXHRcdG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdFx0Y2FsbGJhY2s6ICh2YWx1ZSkgPT4ge1xuXHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdHZhciBjb2RlID0gdmFsdWU7XG5cdFx0XHRcdGdldERhdGFGcm9tQ29kZShjb2RlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGdldENvZGUoXCJObyBjb2RlIGVudGVyZWQuIEVudGVyIHlvdXIgY29kZTpcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn1cblxuaWYgKHBhcmFtcy5jb2RlKSB7XG5cdGdldERhdGFGcm9tQ29kZShwYXJhbXMuY29kZSk7XG59IGVsc2Uge1xuXHRnZXRDb2RlKFwiRW50ZXIgWW91ciBDb2RlXCIpO1xufVxuXG5cbi8vIHZhciBCQVRUTEVfU0VSVkVSX1VSTCA9ICdodHRwczovL2JhdHRsZXNoaXAtdmluZ2thbi5jOXVzZXJzLmlvLzF2MT9wMT1lc2kxNy5jcy5EZXN0cm95ZXJTaGlwJnAyPWVzaTE3LmhsaTEwOS5GbG9hdGVyJzsvLyArIE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTAwKTtcblxuLy8gJC5nZXQoQkFUVExFX1NFUlZFUl9VUkwpLnRoZW4oZGF0YSA9PiB7XG4vLyBcdGlucHV0ID0gZGF0YTtcbi8vIFx0YXBwLmluaXQoKTtcbi8vIH0pLmRvbmUoKCkgPT4ge1xuLy8gXHRjb25zb2xlLmxvZyhcIkRhdGEgc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBmcm9tIHNlcnZlclwiKTtcbi8vIH0pLmZhaWwoKCkgPT4ge1xuLy8gXHRjb25zb2xlLmxvZyhcIlVuYWJsZSB0byByZXRyaWV2ZSBkYXRhLCBzdGFydGluZyB3aXRoIGxvY2FsIGRhdGFcIik7XG4vLyBcdGFwcC5pbml0KCk7XG4vLyB9KTtcblxuXG5cbiJdfQ==\n"]}